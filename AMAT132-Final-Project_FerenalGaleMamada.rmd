---
title: "Time Series Forecasting of Tourist Arrivals in the Philippines"
author: "Pamela Ferenal | Kent Vincent Gale | Jynaine Viel Mamada"
date: "2024-05-31"
output: html_document
header-includes: \pagenumbering{gobble}
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE)
```
<style type="text/css">
body {
  font-family: 'Times New Roman', Times, serif;
  line-height: 1.5;
  margin: 1in;
  font-size: 12pt;
  text-align: justify;
}

p, li {
  font-family: 'Times New Roman', Times, serif;
  font-size: 12pt;
  line-height: 1.5;
  text-align: justify;
}

h1, h2, h3, h4, h5, h6 {
  font-family: 'Times New Roman', Times, serif;
}

h1.title{
  text-align: center;
}

h4.author{
  text-align: center;
}

h4.date{
  text-align: center;
}

p.caption {
  text-align: center;
}
</style>

### 1 INTRODUCTION

The growth in tourist arrivals in the Philippines indicates progress in the country’s tourism industry, which significantly impacts the progress of the Philippine economy as well [1]. Career opportunities across various sectors such as hospitality, transportation, and retail expand as the industry thrives, and so offers employment for the people and provides them with sufficient income [2]. These come from revenue through tourist expenses on accommodation, food, and transport, boosting the local and national economy. Hence, understanding the dynamics of tourist demand is crucial especially now that the country moves toward redeeming social, cultural, and economic development after the COVID-19 pandemic [3]. Such goals call for improvement in services and infrastructure, which require strategic planning and resource allocation by the industry’s stakeholders. Forecasting tourist arrivals is therefore necessary to formulate plans and policies to meet tourist demands [4]. Addressing this concern, this study explores the application of time series decomposition, exponential smoothing, and AutoRegressive Integrated Moving Average (ARIMA) modeling techniques to forecast future tourist arrivals in the Philippines. Recommendations for agencies, particularly the Department of Tourism’s recovery plan, can be acquired from the findings of this study.

**1.1 Objectives**

This time series forecasting on monthly tourist arrivals in the Philippines seeks to identify and understand historical and present patterns, irregularities, and variations in the data, and develop a reliable and accurate forecasting model in predicting tourist arrivals in the country for the next two (2) years. Furthermore, this study intends to estimate the monthly visitor arrivals in the Philippines from February 2020 to April 2024 had the COVID-19 pandemic not occurred. With these applications, this data and forecast analysis aims to contribute to the direction of policy-making and economic planning concerning the tourism industry.


**1.2 Scope of the study**

This study covers monthly time series data of tourist arrivals to the Philippines from January 2008 to April 2024, mainly focusing on the records of arrivals to the country as a whole, with tourists including foreigners and overseas Filipinos. The analysis is divided into two parts: 

1) A short-term forecast of two years length is generated by assessing the best methods and techniques from applying time series decomposition, exponential smoothing, and ARIMA models, and;

2) Similar applications are used to yield estimates for the number of monthly tourist arrivals to the country from February 2020 to April 2024 had there been no pandemic. In addition, because it still has not been that long since the pandemic, and visitor arrivals are still in recovery, the researchers acknowledge the potential impact of the lack of data for post-pandemic forecasts on the validity of the outcome.


**1.3 Significance of the study**

The outcomes of this study will benefit the entire tourism sector—the Department of Tourism (DOT) and partner agencies, tourism businesses, workers, travelers, and all other stakeholders. This analysis and forecast of the number of tourists in the succeeding years would equip policymakers and agencies to devise functional tourism policies and economic planning, from infrastructure management to improving services. The generated forecasts also allow better preparations for demand variations and thus may aid in resource management and implementation of measures needed for a safe and sustainable tourism industry for the country’s development.


### 2 METHODS

**2.1 Data Preprocessing**

The dataset containing records from January 2008 to December 2023 was sourced from Open Data Philippines, an online repository of accessible data from Philippine government agencies [5]. However, recent data from January to April 2024 were collected from the Department of Tourism’s tourism demand statistics [6]. Initially in the form of pdf files with a total size of 5 MB, the authors extracted the number of monthly tourist arrivals in the Philippines—including overseas Filipinos—and transferred them to a separate xlsx file. Upon observation, the original data has a missing value for January 2022, so data imputation was applied to complete the time series data and proceed with the analyses and forecasting.


**2.2 Feature Construction**

As shown in Figure 1, the monthly tourist arrivals in the Philippines from January 2008 to April 2024 were transformed into a time series plot with a frequency of 12. Inspecting the plot of the original data, there is a known break from 2020 to 2022 due to the COVID-19 pandemic.


```{r include = FALSE}
library('readxl') 
library('fpp3') 
library('tidyverse')
library('tseries')
library('ggplot2')
library('stlplus')
library('astsa')
library('forecast')
library('gridExtra')
library('kableExtra')

data = read_excel("C:/Users/Pam/Downloads/Tourist-Arrival-Total-with-OFWs.xlsx")
data
Tourists<-data |>
  mutate (Month = 1:n()) |>
  gather (Year, value, -Month) |>
  arrange (Year, Month) 
Tourists<-ts(Tourists$value/1000, start = c(2008, 1), frequency = 12)
Tourists<-subset(Tourists, end = length(Tourists)-8)
```

```{r, fig.cap='*Figure 1. Time Series Plot of Monthly Tourist Arrivals in the Philipppines*', fig.dim=c(6,3), fig.align='center'}
forecast::autoplot(Tourists)
```

The authors decided to split the dataset into two parts: pre-pandemic and post-pandemic. Forecast methods will be applied to the pre-pandemic data to show the monthly tourist arrivals had the pandemic not occurred. The same will also be applied to post-pandemic data. 

```{r include = FALSE}
#training & test sets for pre pandemic data
training.set.pre.pandemic <- subset(Tourists, end=length(Tourists)-80)
test.set.pre.pandemic <- subset(Tourists, start = length(Tourists)-79, end = length(Tourists)-51)
```

```{r, fig.cap='*Figure 2. Pre-pandemic Monthly Tourist Arrivals in the Philipppines*', fig.dim=c(6,3), fig.align='center'}
forecast::autoplot(Tourists) + autolayer(training.set.pre.pandemic) +autolayer(test.set.pre.pandemic)
```

```{r include = FALSE}
#training & test sets for post pandemic data
training.set.post.pandemic <- subset(Tourists, start = length(Tourists)-26, end = length(Tourists)-11)
test.set.post.pandemic <- subset(Tourists, start = length(Tourists)-10)
length(training.set.post.pandemic)
```

```{r, fig.cap='*Figure 3. Post-pandemic Monthly Tourist Arrivals in the Philipppines*', fig.dim=c(6,3), fig.align='center'}
forecast::autoplot(Tourists) + autolayer(training.set.post.pandemic) + autolayer(test.set.post.pandemic)
```

**2.3 Feature Selection and Transformation**

The authors included a time series decomposition with the values for  both dataset. 
```{r, fig.cap='*Figure 4. Time Series Decomposition for pre-pandemic and post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
datastl <- stlplus(training.set.pre.pandemic,s.window = "period")
plot_pre <- plot(datastl)

datastl <- stlplus(training.set.post.pandemic,s.window = "period")
plot_post <- plot(datastl)

grid.arrange(plot_pre, plot_post, ncol = 2)
```

Upon analyzing the time series decomposition plots, it is apparent that the pre-pandemic data (left) exhibits an obvious increasing trend and seasonality. Whereas the post-pandemic data (right) shows an increasing trend with no clear seasonal behavior. 


**2.4 Model Training, Comparison, and Optimization**

**Forecasting Methods for pre-pandemic data**

The pre-pandemic dataset has 145 data points. The training set comprised the first 80% values of the pre-pandemic data and thus has 116 data points spanning from January 2008 to August 2017, while the test set contains the remaining 29 data points spanning from September 2017 to January 2020. Forecasting methods are then applied. 


**Naive Forecasting**

The pre-pandemic data is subjected to Naive forecasting which uses the last number of  monthly tourist arrivals as the forecasted value for future periods.

```{r, fig.cap='*Figure 5. Naive Forecasting using Pre-pandemic Data*', fig.dim=c(6,3), fig.align='center'}
#naive method pre pandemic
naive_f_pre_p = naive(training.set.pre.pandemic, seasonal = TRUE, h = 29)
autoplot(naive_f_pre_p) + autolayer(test.set.pre.pandemic)
```


**Seasonal Naive Forecasting**

The pre-pandemic data is subjected to Seasonal Naive forecasting which uses the actual monthly tourist arrivals of the last period in the same month as the forecasted value for future periods. 

```{r, fig.cap='*Figure 6. Seasonal Naive Forecasting using Pre-pandemic Data*', fig.dim=c(6,3), fig.align='center'}
snaive_f_pre_p = snaive(training.set.pre.pandemic, seasonal = TRUE, h = 29)
autoplot(snaive_f_pre_p) + autolayer(test.set.pre.pandemic)
```


**Simple Exponential Smoothing**

The pre-pandemic data is subjected to Simple Exponential Smoothing that calculates the forecast value by adding the previous values multiplied to their weights. Forecast values are dictated by a level smoothing parameter that gives exponentially lesser weights given to older observations. 

```{r, fig.cap='*Figure 7. Simple Exponential Smoothing Forecasting using Pre-pandemic Data*', fig.dim=c(6,3), fig.align='center'}
ses_f_pre_p = ses(training.set.pre.pandemic, h = 29)
autoplot(ses_f_pre_p) + autolayer(test.set.pre.pandemic)
```


**Exponential Smoothing: Holt's Linear Method**

The pre-pandemic data is subjected to Holt's Linear Method which calculates forecast values by adding previous values multiplied to their weight plus a trend component. Forecast values are dictated by level and trend smoothing parameters. 

```{r, fig.cap='*Figure 8. Holts Linear Forecasting Method using Pre-pandemic Data*', fig.dim=c(6,3), fig.align='center'}
holt_f_pre_p = holt(training.set.pre.pandemic, h = 29)
autoplot(holt_f_pre_p) + autolayer(test.set.pre.pandemic)
```


**Exponential Smoothing: Holt-Winters' Seasonal Additive and Multiplicative Methods**

The pre-pandemic data is subjected to Holt-Winters' Seasonal Additive and Multiplicative Methods. In the additive method, the seasonal component is absolute and the series is adjusted by subtracting it. The seasonal component sums to zero annually. In the multiplicative method, the seasonal component is relative (percentages) and the series is adjusted by dividing by it.

```{r, fig.cap='*Figure 9. Holt-Winters Seasonal Additive Forecasting Method using Pre-pandemic Data*', fig.dim=c(6,3), fig.align='center'}
hwfit1_pre_p <- hw(training.set.pre.pandemic, h=29, seasonal = "additive")
autoplot(hwfit1_pre_p) + autolayer(test.set.pre.pandemic)
```

```{r, fig.cap='*Figure 10. Holt-Winters Seasonal Multiplicative Forecasting Method using Pre-pandemic Data*', fig.dim=c(6,3), fig.align='center'}
hwfit2_pre_p <- hw(training.set.pre.pandemic, h=29, seasonal = "multiplicative")
autoplot(hwfit2_pre_p) + autolayer(test.set.pre.pandemic)
```


**Exponential Smoothing: Damped Trend**

The pre-pandemic data is subjected to Damped Trend method which calculates forecast value by adding previous actual values multiplied to their weights plus a trend component. Forecast values are dictated by a level, trend and a trend damping parameter.

```{r, fig.cap='*Figure 11. Damped Trend Forecasting Methods using Pre-pandemic Data*', fig.dim=c(6,3), fig.align='center'}
damp_f_pre_p <- holt(training.set.pre.pandemic, damped = TRUE, phi = 0.8, h = 29)
autoplot(damp_f_pre_p) + autolayer(test.set.pre.pandemic)
```


**Seasonal AutoRegressive Integrated Moving Average (SARIMA)**

Stationarity is an important assumption when using ARIMA Models. Looking at Figure 4, particularly at the time series decomposition of the pre-pandemic data, there is an increasing trend and seasonality where data exhibits long-term increase and seasonal behavior. Thus, the pre-pandemic data is non-stationary. To verify this, the Augmented Dickey-Fuller (ADF) test is used to determine if the time series is stationary or not. 

```{r include = FALSE}
#Augmented Dickey-Fuller (ADF) test to show if time series is stationary or not
adf.test(training.set.pre.pandemic, k=12)
```

The results revealed a p-value of **(0.5972)** which is significantly greater than the level of significance p-value **(0.05)**. Failure to reject the null hypothesis confirms that the data is in its non-stationary status. Hence, differencing is necessary to remove the non-stationary behavior.

```{r include = FALSE}
d.pre.pandemic <- diff(training.set.pre.pandemic, differences = 1)
adf.test(d.pre.pandemic, k=12)
```

```{r, fig.cap= '*Figure 12. The pre-pandemic data after first level differencing*', fig.dim=c(6,3), fig.align='center'}
plot(d.pre.pandemic)
```
After applying first-level differencing and implementing the Augmented Dickey-Fuller (ADF) test, the data became stationary. Results revealed a p-value of **(0.02784)** which is less than the p-value **(0.05)**. Looking at the plot of the data after differencing, its increasing trend was removed but seasonal effects were still evident. Thus, the authors applied a seasonal differencing to remove seasonality. 

```{r include = FALSE}
ds.pre.pandemic <- diff(d.pre.pandemic, lag=12, differences = 1) 
autoplot(ds.pre.pandemic)
adf.test(ds.pre.pandemic, k=12)
```

After applying a seasonal difference, the authors obtained a p-value of **(0.06364)**, which is greater than the p-value **(0.05)**. Hence, failure to reject the null hypothesis confirmed the need for a seasonal difference again to make the data stationary. 

```{r, fig.cap= '*Figure 13. The pre-pandemic data after two seasonal differences*', fig.dim=c(6,3), fig.align='center'}
ds.pre.pandemic <- diff(d.pre.pandemic, lag=12, differences = 2) 
autoplot(ds.pre.pandemic)
```
```{r include= FALSE}
adf.test(ds.pre.pandemic, k=12)
```


After applying a second seasonal difference, the authors obtained a p-value **(0.02784)**, which is lower than the level of significance **(0.05)**, thereby confirming  its stationary status. Since the pre-pandemic data became stationary after undergoing first level differencing, the authors assigned a value of 1 to 'd', thus d = 1. Seasonal differencing was performed twice, so the value for 'D' was set to 2, thus D = 2, These values correspond to the seasonal parameters of the model in SARIMA(p,d,q)(P,D,Q)[12].

To determine the appropriate SARIMA model for the pre-pandemic data, the authors examined the Autocorrelation plots function (ACF) and Partial Autocorrelation Function (PACF) plots. These plots will help in determining the parameter values in SARIMA(p,d,q)(P,D,Q)[12]. 

```{r, fig.cap= '*Figure 14. The ACF and PACF plots*', fig.dim=c(5,3), fig.align='center'}
par(mar = c(1, 1, 1, 1))
forecast::tsdisplay(ds.pre.pandemic)
```


As shown above, the PACF exhibited a significant spike at lag 1, indicating a strong positive correlation with a one-period lag. This suggests a SARIMA model with AR(1). The ACF plot, conversely, showed that after lag 1, the correlations are primarily within significance bounds, suggesting a SARIMA model with MA(1).

For the seasonal component of the SARIMA model, the PACF at its seasonal lag (12) displayed a significant spike at lag 12, suggesting a SARIMA model with seasonal AR(1). The ACF plot at its seasonal lag (12) also showed a significant spike at lag 12 suggesting a SARIMA model with seasonal MA(1). Compiling all identified parameters, the SARIMA model based on the ACF and PACF plots is SARIMA(1,1,1)(1,2,1)[12].

```{r include = FALSE}
SarimaModel <- arima(training.set.pre.pandemic, order = c(1, 1, 1),seasonal = list(order = c(1,2,1), period = 12)) #AIC=840.24
SarimaModel
SarimaModel_pre_p <- forecast(SarimaModel, h = 29)
```

```{r, fig.cap= '*Figure 15. Seasonal AutoRegressive Integrated Moving Average Forecasting Method*', fig.dim=c(6,3), fig.align='center'}
autoplot(forecast(SarimaModel_pre_p)) + autolayer(test.set.pre.pandemic)
```

To visualize and compare the forecasts from all forecasting methods employed on the pre-pandemic data: 
```{r, fig.cap= '*Figure 16. All forecasting methods applied to the pre-pandemic data*', fig.dim=c(6,3), fig.align='center'}
#Plot for the forecasts of all forecasting methods pre-pandemic
(autoplot(Tourists) +  
   autolayer(naive_f_pre_p$mean, series = "Naive") +
   autolayer(snaive_f_pre_p$mean, series = "S.Naive") +
   autolayer(ses_f_pre_p$mean, series = "SES") +
   autolayer(holt_f_pre_p$mean, series = "Holt Linear") +
   autolayer(hwfit1_pre_p$mean, series = "Holt Seasonal Additive") +
   autolayer(hwfit2_pre_p$mean, series = "Holt Seasonal Multiplicative") +
   autolayer(damp_f_pre_p$mean, series = "Damp Trend") +
   autolayer(SarimaModel_pre_p$mean, series = "SARIMA") +
   guides(colour = guide_legend("Model")) +
   ggtitle("Supposed Tourist Arrivals in the Philippines") +
   xlab("Year") + ylab("Tourists in thousands"))
```


**Forecasting Methods for post-pandemic data**

The post-pandemic dataset consists of 26 data points. Since there are only few observations, the training set contained the first 60% of the dataset, spanning from February 2022 to May 2023 (15 data points), and the remaining 40% (11 data points) are part of the test set, spanning from June 2023 to April 2024. Subsequently, forecasting methods are applied.
 
**Naive Forecasting**
```{r, fig.cap= '*Figure 17. Naive Forecasting using Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
naive_f_post_p = naive(training.set.post.pandemic, seasonal = TRUE, h = 11)
autoplot(naive_f_post_p) + autolayer(test.set.post.pandemic)
```

**Seasonal Naive Forecasting**
```{r, fig.cap= '*Figure 18. Seasonal Naive Forecasting using Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
#seasonal naive method post pandemic
snaive_f_post_p = snaive(training.set.post.pandemic, seasonal = TRUE, h = 11)
autoplot(snaive_f_post_p) + autolayer(test.set.post.pandemic)
```

**Simple Exponential Smoothing Forecasting**
```{r, fig.cap= '*Figure 19. Simple Exponential Smoothing Forecasting using Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
#simple exponential smoothing post pandemic
ses_f_post_p = ses(training.set.post.pandemic, h = 11)
autoplot(ses_f_post_p) + autolayer(test.set.post.pandemic)
```

**Exponential Smoothing: Holt's linear Forecasting**
```{r, fig.cap= '*Figure 20. Holt Linear Forecasting Method using Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
#Exponential smoothing: Holt's linear method post pandemic
holt_f_post_p = holt(training.set.post.pandemic, h = 11)
autoplot(holt_f_post_p) + autolayer(test.set.post.pandemic)
```

**Exponential Smoothing: Holt-Winters' Seasonal Additive and Multiplicative Methods**
```{r include= FALSE}
#Exponential Smoothing: Holt-Winter’s Seasonal Additive post pandemic
hwfit1_post_p <- hw(training.set.post.pandemic, h=11, seasonal = "additive")
```

```{r, fig.cap= '*Figure 21. Holt-Winter’s Seasonal Additive Forecasting Method using Post-pandemic*', fig.dim=c(6,3), fig.align='center'}
autoplot(hwfit1_post_p) + autolayer(test.set.post.pandemic)
```

```{r include= FALSE}
#Exponential Smoothing: Holt-Winter’s Seasonal Multiplicative post pandemic
hwfit2_post_p <- hw(training.set.post.pandemic, h=11, seasonal = "multiplicative")
```

```{r, fig.cap= '*Figure 22. Holt-Winter’s Seasonal Multiplicative Forecasting Method using Post-pandemic*', fig.dim=c(6,3), fig.align='center'}
autoplot(hwfit2_post_p) + autolayer(test.set.post.pandemic)
```

**Exponential Smoothing: Damp Trend**
```{r, fig.cap= '*Figure 23. Damp Trend Forecasting Method using Post-pandemic*', fig.dim=c(6,3), fig.align='center'}
#Exponential Smoothing: Damp trend post pandemic
damp_f_post_p <- holt(training.set.post.pandemic, damped = TRUE, phi = 0.8, h = 11)
autoplot(damp_f_post_p) + autolayer(test.set.post.pandemic)
```


**ARIMA for post pandemic data**

Stationarity is an important assumption when using ARIMA Models. As observed in Figure 4, particularly in the time series decomposition of the post-pandemic data, there is an increasing trend and no apparent seasonality. This suggests that the data is nonstationary. To verify this, the Augmented Dickey-Fuller (ADF) test is used to determine whether the time series is stationary or not. 

```{r include = FALSE}
#Augmented Dickey-Fuller (ADF) test to show if time series is stationary or not
adf.test(training.set.post.pandemic, k=1)
```

The ADF test revealed a p-value of **(0.5682)**, which is significantly greater than the level of significance p-value **(0.05)**. The failure to reject the null hypothesis confirms that the data is non-stationary. Thus, differencing is necessary to remove the non-stationary behavior.

```{r include = FALSE}
d.post.pandemic <- diff(training.set.post.pandemic, differences = 3)
adf.test(d.post.pandemic, k=1)
```

After implementing third-level differencing, the authors obtained a p-value **(0.02403)** which is lower than the level of significance **(0.05)**, thereby confirming its stationary status. Since the post-pandemic data became stationary after undergoing third differencing, the authors assigned a value of 3 to 'd', thus d=3. This value corresponds to the parameters of the model in ARIMA(p,d,q).

To determine the appropriate ARIMA model for the post-pandemic data, the authors will present the Autocorrelation function (ACF) and Partial Autocorrelation Function (PACF) plots. These plots will help determine other parameter values needed for ARIMA(p,d,q).

```{r, fig.cap= '*Figure 24. The ACF and PACF plots for Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
#Checking the acf and pacf of deseasoned data 
par(mar = c(1, 1, 1, 1))
forecast::tsdisplay(d.post.pandemic)
```
As shown above, the PACF displays one significant spike at lag 1 and then cuts off. This suggests an ARIMA model with AR(1). The ACF plot shows correalations starting off positive and oscillating around zero without any clear pattern. This suggests an ARIMA model with MA(0). Thus, ARIMA(1,3,0) is considered. 

However, the post-pandemic dataset has fewer than 40 data points, making this time series short. Therefore, the authors utilized the *auto.arima()* function to determine the appropriate ARIMA model. The resulting ARIMA model is ARIMA(0,1,1) which the authors also considered. 

```{r include = FALSE}
auto.arima(training.set.post.pandemic)
ArimaModel1 <- Arima(training.set.post.pandemic, order = c(0,1,1)) #AICc=158.08   
ArimaModel2 <- Arima(training.set.post.pandemic, order = c(1,3,0)) #AICc=147.49
ArimaModel2
```


```{r fig.cap= '*Table 1. Akaike Information Criterion with a correction (AICc) values of the two (2) ARIMA Models*', fig.height=1, fig.width=1, fig.align='center', paged.print=TRUE}
AICC <- data.frame(NO. = 1:2, Model = c("ARIMA(0,1,1)","ARIMA(1,3,0)"), 
                            AICc = c(158.08, 147.49))
kable(AICC, caption = "The AICc values of the two (2) ARIMA models", booktabs = T) %>%
    kable_styling(latex_options = "hold_position") %>%
    kable_styling(latex_options = "striped")
```

The Akaike Information Criterion with a correction (AICc) was used to compare the two ARIMA models under consideration. From the table above, Model 2 has lower AICc of **(147.49)** compared to the other model. Therefore, the ARIMA(1,3,0) is selected for comparison with other forecasting methods used. 

```{r, fig.cap= '*Figure 25. AutoRegressive Integrated Moving Average (ARIMA) Forecasting using Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
ArimaModel_post_p <- forecast(ArimaModel2, h = 11)
autoplot(ArimaModel_post_p) + autolayer(test.set.post.pandemic)
```

To visualize and compare the forecasts from all forecasting methods employed on the post-pandemic data: 

```{r, fig.cap= '*Figure 26. Plot for the forecasts of all forecasting methods*', fig.dim=c(6,3), fig.align='center'}
#Plot for the forecasts of all forecasting methods post-pandemic
(autoplot(Tourists) +  
    autolayer(naive_f_post_p$mean, series = "Naive") +
    autolayer(snaive_f_post_p$mean, series = "S.Naive") +
    autolayer(ses_f_post_p$mean, series = "SES") +
    autolayer(holt_f_post_p$mean, series = "Holt Linear") +
    autolayer(hwfit1_post_p$mean, series = "Holt Seasonal Additive") +
    autolayer(hwfit2_post_p$mean, series = "Holt Seasonal Multiplicative") +
    autolayer(damp_f_post_p$mean, series = "Damp Trend") +
    autolayer(ArimaModel_post_p$mean, series = "ARIMA") +
    guides(colour = guide_legend("Model")) +
    ggtitle("Tourist Arrivals in the Philippines") +
    xlab("Year") + ylab("Tourists in thousands"))
```

**2.5 MODEL VALIDATION**

**For Pre-pandemic data**
```{r include = TRUE}
pre.pandemic.models <- list(naive_f_pre_p, snaive_f_pre_p, ses_f_pre_p, holt_f_pre_p, hwfit1_pre_p, hwfit2_pre_p, damp_f_pre_p, forecast(SarimaModel_pre_p))
pre.pandemic.results <- data.frame()

for(model in pre.pandemic.models){
  #Compute error metrics for the forecasting model
  model.accuracy <- accuracy(model, test.set.pre.pandemic)
  
  #Summarize error metrics of the forecasting model
  model.summary <- c(RMSE = model.accuracy[, "RMSE"]["Test set"],
                     MAE = model.accuracy[, "MAE"]["Test set"],
                     MPE = model.accuracy[, "MPE"]["Test set"],
                     MAPE = model.accuracy[, "MAPE"]["Test set"])
  
  #Compile error metric summary in a single data frame
  pre.pandemic.results <- rbind(pre.pandemic.results, model.summary)
}

#Naming rows and columns of error metric summary
rownames(pre.pandemic.results) <- c("naive_f", "snaive_f", "ses_f_pre_p", "holt_f_pre_p", "hwfit1_pre_p", "hwfit2_pre_p", "damp_f_pre_p", "SarimaModel_pre_p")
colnames(pre.pandemic.results) <- c("RMSE", "MAE", "MPE", "MAPE")
```

```{r include = TRUE}
#Printing error metric summary
print(pre.pandemic.results)
```

The best fit model was assessed by utilizing Root Mean Squared Error (RMSE), a metric used to evaluate the accuracy of a predictive model by measuring the average magnitude of the prediction errors. The authors also considered other error metrics such as Mean Absolute Error (MAE), Mean Percentage Error (MPE), and Mean Absolute Percentage Error (MAPE).

Among the eight (8) models, it was observed that the  SARIMA(1,1,1)(1,2,1)[12] model exhibited the smallest error in RMSE is the SARIMA(1,1,1)(1,2,1)[12] which is **42.14047**. The model also exhibited the least error in MAE at **34.01040**, MPE at **4.045046**, and MAPE at **5.256408**. Hence, the model that will be used for data forecasting is SARIMA(1,1,1)(1,2,1)[12].


**For Post-pandemic data** 
```{r include = TRUE}
#Comparing error metrics of post pandemic forecasts
post.pandemic.models <- list(naive_f_post_p, snaive_f_post_p, ses_f_post_p, holt_f_post_p, hwfit1_post_p, hwfit2_post_p, damp_f_post_p, forecast(ArimaModel_post_p))
post.pandemic.results <- data.frame()
for(model in post.pandemic.models){
  #Compute error metrics for the forecasting model
  model.accuracy <- accuracy(model, test.set.post.pandemic)
  
  #Summarize error metrics of the forecasting model
  model.summary <- c(RMSE = model.accuracy[, "RMSE"]["Test set"],
                     MAE = model.accuracy[, "MAE"]["Test set"],
                     MPE = model.accuracy[, "MPE"]["Test set"],
                     MAPE = model.accuracy[, "MAPE"]["Test set"])
  
  #Compile error metric summary in a single data frame
  post.pandemic.results <- rbind(post.pandemic.results, model.summary)
}

#Naming rows and columns of error metric summary
rownames(post.pandemic.results) <- c("naive_f", "snaive_f", "ses_f_pre_p", "holt_f_pre_p", "hwfit1_pre_p", "hwfit2_pre_p", "damp_f_pre_p", "ArimaModel_post_p")
colnames(post.pandemic.results) <- c("RMSE", "MAE", "MPE", "MAPE")
```

```{r include= TRUE}
#Printing error metric summary
print(post.pandemic.results)
```

The best fit model was assessed by utilizing Root Mean Squared Error (RMSE), a metric used to evaluate the accuracy of a predictive model by measuring the average magnitude of the prediction errors. The authors also considered utilizing 
other error metrics such as Mean Absolute Error (MAE), Mean Percentage Error (MPE), and Mean Absolute Percentage Error (MAPE).

Among the eight (8) models, it was observed that the 3 models with the least RMSE are Simple Exponential Smoothing, Naive Model, and Holt's Linear Method, with RMSEs of **115.1893**, **115.1949**, and **115.6280**, respectively. In MAE and MPE, the model that has least error is Holt's Linear Forecasting Method. While Simple Exponential Smoothing and the Naive Model have the least RMSEs, they fail to capture the data's trend. Holt's Linear Method, however, captures the presence of a positive trend in the data, while still having a similarly low RMSE to Simple Exponential Smoothing and the Naive Method. Hence, the model that will be used for data forecasting is Holt's Linear Method.

### RESULTS AND DISCUSSION 

**Pre-pandemic data**

SARIMA(1,1,1)(1,2,1)[12] was identified as the best model among the tested models for pre-pandemic data to forecast the monthly tourist arrivals in the Philippines from February 2020 to April 2024 had there been no COVID-19 outbreak.

```{r, fig.cap= '*Figure 27. AutoRegressive Integrated Moving Average (ARIMA) Forecasting using Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
#Forecasting 2 years in the future using SARIMA trained with pre-pandemic data
pre.pandemic.data <- subset(Tourists, end = length(Tourists)-51)
SarimaModel <- arima(pre.pandemic.data, order = c(1, 1, 1),seasonal = list(order = c(1,2,1), period = 12)) #AIC=840.24
SarimaModel_pre_p <- forecast(SarimaModel, h=24)
(autoplot(Tourists) +  
    autolayer(SarimaModel_pre_p, series = "SARIMA") +
    guides(colour = guide_legend("Model")) +
    ggtitle("Supposed Tourist Arrivals in the Philippines") +
    xlab("Year") + ylab("Tourists in thousands"))
```

The forecast plot shows that the number of arrivals in the Philippines would have continued an increasing trend and maintained seasonality behavior. Over time, the variability in the data also increases as demonstrated by the widening of peaks and troughs in the plot.


**Post-pandemic data**

The Holt's Linear Method was applied to forecast the monthly tourist arrivals in the Philippines for the next two years. 
```{r, fig.cap= '*Figure 28. AutoRegressive Integrated Moving Average (ARIMA) Forecasting using Post-pandemic data*', fig.dim=c(6,3), fig.align='center'}
### For post-pandemic data
#Forecasting 2 years in the future using SES trained with post-pandemic data
#simple exponential smoothing post pandemic
post.pandemic.data <- subset(Tourists, start = length(Tourists)-26)
holt_f_post_p_a = holt(post.pandemic.data, h = 48)

autoplot(Tourists) +  
    autolayer(holt_f_post_p_a, series = "Holt linear") +
    guides(colour = guide_legend("Model")) +
    ggtitle("Tourist Arrivals in the Philippines") +
    xlab("Year") + ylab("Tourists in thousands")
```

Based on the forecast plot, the monthly tourist arrivals in the Philippines over the next two years will continue to increase, though it has not fully recovered to the pre-pandemic growth trajectory. The authors acknowledge the potential impact of the lack of data for post-pandemic forecasts on the validity of the outcome.

### CONCLUSION

Based on the study’s results, the authors applied eight (8) forecasting methods for both pre-pandemic and post-pandemic data. The pre-pandemic data on tourist arrivals exhibited a clear increasing trend and seasonality, while the post-pandemic data showed an increasing trend with no clear seasonality. The data corresponding to the lockdown dates during the pandemic exhibited a structural break in the form of a trough.The best forecasting model for the pre-pandemic data according to the least RMSE, is SARIMA. Meanwhile, the best forecasting model for post-pandemic data, according to the least RMSE while still capturing the positive trend post-pandemic, is Holt’s Linear Method. 

According to the forecasted data from the SARIMA model, had the pandemic not occurred, total tourists arrivals would have continued to increase, following a seasonal pattern. On the other hand, forecasted data based on Holt’s Linear Method, show future total tourist arrivals will continue to increase following no seasonal pattern. The authors recommend future analysis and forecast of tourist arrivals in the Philippines to employ multivariate time series models to incorporate variables such as economic indicators, travel trends, and policy changes for more accurate predictions.

### CODES
https://github.com/K-AMAT/AMAT-132-PROJECT

### REFERENCES
[1] L. Desiderio, “S&P: Tourism a vital growth driver for Philippine economy,” Philstar.com, Jun. 26, 2023. [Online]. Available: https://www.philstar.com/business/2023/06/27/2276738/sp-tourism-vital-growth-driver-philippine-economy  

[2] K. D. Yu, “An economic analysis of the Philippine tourism industry,” Dlsu Business Economics Review, vol. 22, no. 1, p. 119, Apr. 2012, [Online]. Available: https://www.iioa.org/conferences/19th/papers/files/367.pdf

[3] Department of Tourism, “DOT outlines tourism response, post-COVID 19 recovery plan to aid private sector,” Department of Tourism, May 06, 2022. https://beta.tourism.gov.ph/news_and_updates/dot-outlines-tourism-response-post-covid-19-recovery-plan-to-aid-private-sector/

[4] S. F. Witt and C. A. Witt, “Forecasting tourism demand: A review of empirical research,” International Journal of Forecasting, vol. 11, no. 3, pp. 447–475, Sep. 1995, doi: 10.1016/0169-2070(95)00591-7.

[5] “Open data Philippines.” https://data.gov.ph/index/home

[6] “Department of Tourism-Philippines.” http://www.tourism.gov.ph/tourism_dem_sup_pub.aspx

